<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • assemblerr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="assemblerr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">assemblerr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9007</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
                        <h4 class="author">Sebastian Ueckert</h4>
            
            <h4 class="date">2021-06-17</h4>
      
      
      <div class="hidden name"><code>introduction.rmd</code></div>

    </div>

    
    
<p>assemblerr is an R package to construct pharmacometric models by combining pre-defined model components. It’s intended to simplify the specification of complex pharmacometric models and provide a mechanism to generate models in an automatic way. With assemblerr, models are specified using R code and then converted to a NONMEM control stream.</p>
<p>The following code snippet builds a simple pharmacometric model</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load assemblerr</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">assemblerr</span><span class="op">)</span>

<span class="co"># create a model and add components</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"v"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"cl"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/obs_additive.html">obs_additive</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">amt</span><span class="op">/</span><span class="va">v</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">cl</span><span class="op">/</span><span class="va">v</span><span class="op">*</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># generate NONMEM model file</span>
<span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">m</span>, filename <span class="op">=</span> <span class="st">"run1.mod"</span><span class="op">)</span> </code></pre></div>
<p>The example above illustrates the general three-step workflow in assemblerr:</p>
<ol style="list-style-type: decimal">
<li>A model object is created using the <code><a href="../reference/model.html">model()</a></code> function</li>
<li>Building blocks are added to the model using the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> operator</li>
<li>The <code><a href="../reference/render.html">render()</a></code> function generates the NMTRAN code</li>
</ol>
<p>No matter what type of model you are trying to assemble, this workflow will be the same. The difference lies in the creation function being used in step 1, the building blocks being added in step 2, and the options selected for the rendering in step 3.</p>
<div id="model-types" class="section level2">
<h2 class="hasAnchor">
<a href="#model-types" class="anchor"></a>Model types</h2>
<p>The creation function defines the overal scope of the model by deciding which facets the model possesses. A facet is a particular feature of a model, such as the model parameters or the compartments for differential equation models. Currently, assemblerr supports two types of pharmacometric models</p>
<ol style="list-style-type: decimal">
<li>
<strong>General pharmacometric models:</strong> The lowest level of abstraction that allows the creation of a wide range of models but requires a more fine-grained definition process. They are created using the function <code><a href="../reference/model.html">model()</a></code>.</li>
<li>
<strong>Pharmacokinetic models:</strong> A higher level of abstraction that allows the definition of pharmacokinetic models with less effort. Pharmacokinetic models are created using the function <code><a href="../reference/pk_model.html">pk_model()</a></code>.</li>
</ol>
<p>The following two code sections illustrate the differences between these two types of models by specifying the same pharmacokinetic model using both model types.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specification using a general pharmacometric model</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"mat"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"vc"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"cl"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/algebraic.html">algebraic</a></span><span class="op">(</span><span class="va">ka</span><span class="op">~</span><span class="fl">1</span><span class="op">/</span><span class="va">mat</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/compartment.html">compartment</a></span><span class="op">(</span><span class="st">"dose"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/compartment.html">compartment</a></span><span class="op">(</span><span class="st">"central"</span>, volume <span class="op">=</span> <span class="op">~</span><span class="va">vc</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/flow.html">flow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"dose"</span>, to <span class="op">=</span> <span class="st">"central"</span>, definition <span class="op">=</span> <span class="op">~</span><span class="va">ka</span><span class="op">*</span><span class="va">A</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/flow.html">flow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"central"</span>, definition <span class="op">=</span> <span class="op">~</span><span class="va">cl</span><span class="op">*</span><span class="va">C</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/obs_additive.html">obs_additive</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">C</span><span class="op">[</span><span class="st">"central"</span><span class="op">]</span><span class="op">)</span> 

<span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code></pre></div>
<pre><code>## $PROBLEM
## $INPUT ID TIME DV AMT
## $DATA data.csv IGNORE=@
## $SUBROUTINES ADVAN2  TRANS2 
## $PK
## MAT = THETA(1) * EXP(ETA(1))
## VC = THETA(2) * EXP(ETA(2))
## CL = THETA(3) * EXP(ETA(3))
## KA = 1/MAT
## V = VC
## $ERROR
## CONC = A(2)/VC
## Y = CONC + EPS(1)
## $ESTIMATION METHOD=COND MAXEVAL=999999
## $THETA (0, 1, Inf) ; POP_MAT
## $THETA (0, 1, Inf) ; POP_VC
## $THETA (0, 1, Inf) ; POP_CL
## $OMEGA 0.1 ; IIV_MAT
## $OMEGA 0.1 ; IIV_VC
## $OMEGA 0.1 ; IIV_CL
## $SIGMA 1; RUV_ADD</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specification using a pharmacokinetic model</span>
<span class="va">pkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk_model.html">pk_model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">pk_absorption_fo</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/pk_distribution_1cmp.html">pk_distribution_1cmp</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">pk_elimination_linear</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/obs_additive.html">obs_additive</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">C</span><span class="op">[</span><span class="st">"central"</span><span class="op">]</span><span class="op">)</span> 

<span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">pkm</span><span class="op">)</span></code></pre></div>
<pre><code>## $PROBLEM
## $INPUT ID TIME DV AMT
## $DATA data.csv IGNORE=@
## $SUBROUTINES ADVAN2  TRANS2 
## $PK
## MAT = THETA(1) * EXP(ETA(1))
## VC = THETA(2) * EXP(ETA(2))
## CL = THETA(3) * EXP(ETA(3))
## KA = 1/MAT
## V = VC
## $ERROR
## CONC = A(2)/VC
## Y = CONC + EPS(1)
## $ESTIMATION METHOD=COND MAXEVAL=999999
## $THETA (0, 0.5, Inf) ; POP_MAT
## $THETA (0, 100, Inf) ; POP_VC
## $THETA (0, 50, Inf) ; POP_CL
## $OMEGA 0.1 ; IIV_MAT
## $OMEGA 0.1 ; IIV_VC
## $OMEGA 0.1 ; IIV_CL
## $SIGMA 1; RUV_ADD</code></pre>
</div>
<div id="building-blocks" class="section level2">
<h2 class="hasAnchor">
<a href="#building-blocks" class="anchor"></a>Building blocks</h2>
<p>Building blocks are one or more features that are to be added to a model. The blocks are created by calling one of the building block functions and added using the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> operator. The prefix of the building block functions indicates the type of building block (e.g., <code>prm_</code> for model parameters) and, in combination with autocomplete, enables a quick overview of the available blocks of a given type.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"base"</span><span class="op">)</span></code></pre></div>
<p>It is also possible to combine several building blocks and add the resulting fragment to a model:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prm_log_normal.html">prm_log_normal</a></span><span class="op">(</span><span class="st">"base"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/prm_normal.html">prm_normal</a></span><span class="op">(</span><span class="st">"slp"</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">prms</span></code></pre></div>
<p>The order of addition, generally, does not matter unless a building block replaces another one of the same name (e.g., two parameters with the same name).</p>
<div id="available-building-blocks" class="section level3">
<h3 class="hasAnchor">
<a href="#available-building-blocks" class="anchor"></a>Available building blocks</h3>
<dl>
<dt>Algebraics</dt>
<dd>Defines an algebraic relationship for a variable
</dd>
<dd>Function: algebraics
</dd>
<dd>Example: <code><a href="../reference/algebraic.html">algebraic(k ~ cl/v)</a></code>
</dd>
<dt>Compartments</dt>
<dd>Defines the name and volume for a compartment
</dd>
<dd>Function: compartment
</dd>
<dd>Example: <code><a href="../reference/compartment.html">compartment("central", volume = ~vc)</a></code>
</dd>
<dt>Flows</dt>
<dd>Defines flows between compartments
</dd>
<dd>Function: flow
</dd>
<dd>Example: <code><a href="../reference/flow.html">flow(from = "central", definition = ~k*C)</a></code>
</dd>
<dt>Observations</dt>
<dd>Defines an observational model for a variable
</dd>
<dd>Functions: obs_additive, obs_combined, obs_proportional
</dd>
<dd>Example: <code><a href="../reference/obs_combined.html">obs_combined(c~C["central"])</a></code>
</dd>
<dt>Parameters</dt>
<dd>Defines the name and distribution of a model parameter
</dd>
<dd>Functions: prm_log_normal, prm_logit_normal, prm_no_var, prm_normal
</dd>
<dd>Example: <code><a href="../reference/prm_log_normal.html">prm_log_normal("cl")</a></code>
</dd>
<dt>PK components</dt>
<dd>Defines pharmacokinetic model components for absorption, distribution and elimination
</dd>
<dd>Functions: pk_absorption_fo, pk_absorption_fo_lag, pk_absorption_fo_transit, pk_absorption_fo_zo, pk_absorption_zo, pk_absorption_zo_lag, pk_distribution_1cmp, pk_distribution_2cmp, pk_distribution_3cmp, pk_elimination_linear, pk_elimination_linear_mm, pk_elimination_mm, pk_elimination_nl, pk_model
</dd>
<dd>Example: <code>pk_elimination_linear()</code>
</dd>
</dl>
</div>
</div>
<div id="rendering" class="section level2">
<h2 class="hasAnchor">
<a href="#rendering" class="anchor"></a>Rendering</h2>
<p>The function <code><a href="../reference/render.html">render()</a></code> translates the assembled model to NMTRAN and the function arguments control this process.</p>
<div id="output-code-to-console" class="section level3">
<h3 class="hasAnchor">
<a href="#output-code-to-console" class="anchor"></a>Output code to console</h3>
<p>By default the function will output the NMTRAN code to the console.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code></pre></div>
</div>
<div id="output-to-a-file" class="section level3">
<h3 class="hasAnchor">
<a href="#output-to-a-file" class="anchor"></a>Output to a file</h3>
<p>When the <code>filename</code> argument is specified, the model will be written to the selected file.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">m</span>, filename <span class="op">=</span> <span class="st">"run1.mod"</span><span class="op">)</span></code></pre></div>
</div>
<div id="options" class="section level3">
<h3 class="hasAnchor">
<a href="#options" class="anchor"></a>Options</h3>
<p>Some aspectes to the rendering process can be controlled using the <code>options</code> argument. It is best used in conjunction with the <code>assemblerr_options()</code> function. For example, the following snippet produces a mu-referenced version of the model m.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="va">m</span>, 
       options <span class="op">=</span> <span class="fu">assemblerr_options</span><span class="op">(</span>prm.use_mu_referencing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>writes the NMTRAN code for the provided model to the console</p>
<p>The translation of the specified model to NMTRAN is controlled via arguments to the render function. By default the function will output the NMTRAN code to the console, unless the <code>filename</code> argument is specified, in which case the model will be written to the requested file.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Ueckert, F. Hoffmann-La Roche Ltd..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
