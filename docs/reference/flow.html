<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flow between compartments — flow • assemblerr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Flow between compartments — flow" />
<meta property="og:description" content="This building block describes a flow between compartments." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">assemblerr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/UUPharmacometrics/assemblerr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flow between compartments</h1>
    <small class="dont-index">Source: <a href='https://github.com/UUPharmacometrics/assemblerr/blob/master/R/compartment.R'><code>R/compartment.R</code></a></small>
    <div class="hidden name"><code>flow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This building block describes a flow between compartments.</p>
    </div>

    <pre class="usage"><span class='fu'>flow</span><span class='op'>(</span><span class='va'>definition</span>, from <span class='op'>=</span> <span class='cn'>NA_character_</span>, to <span class='op'>=</span> <span class='cn'>NA_character_</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>definition</th>
      <td><p>Equation describing the flow</p></td>
    </tr>
    <tr>
      <th>from</th>
      <td><p>Name of the source compartment (NA for an inflow without source)</p></td>
    </tr>
    <tr>
      <th>to</th>
      <td><p>Name of the sink compartment (NA for an ouflow without sink)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Flows define the connections between compartments and the equations according to which exchanges occur.</p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Flow equations</h3>


<p>The first function argument is the flow equation. It is defined using R formulas that can start with the tilde <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code> operator and do not
need to have a left-hand side (i.e., <code>~k0</code> is a valid flow definition).</p>
<p>Flow equations can contains the special variables <code>A</code> and <code>C</code> which can be used to refer to the amount and concentration in the compartment specified via
the <code>from=</code> argument. For example, the following code creates a flow building block describing the first-order transfer from the depot to the central
compartment</p><pre><span class='fu'>flow</span><span class='op'>(</span><span class='op'>~</span><span class='va'>ka</span><span class='op'>*</span><span class='va'>A</span>, <span class='st'>"depot"</span>, <span class='st'>"central"</span><span class='op'>)</span>
</pre>

<p>When the model is rendered, <code>A</code> and <code>C</code> will get replaced with the corresponding compartment reference. assemblerr will raise an error if <code>A</code> or <code>C</code> are used
without specifying the <code>from=</code> compartment (such as in an inflow).</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Compartment connections</h3>


<p>The connection between compartments can be specified using the <code>from=</code> and <code>to=</code> arguments of the function. Setting either <code>from=</code> or <code>to=</code> to <code>NA</code> allows
the definition of in and outflows without a source or sink. Setting both arguments to <code>NA</code> results in error.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Conversion to differential equations</h3>


<p>When flows are rendered they are converted to ordinary differential equations (ODEs). The connection between compartments together with the flow equations allow
assemblerr to determine whether an analytic solution can be generated. This automatic optimization of differential equations can be disabled via the rendering
options.</p>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># one-compartment model with first-order elimination</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='model.html'>model</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='prm_log_normal.html'>prm_log_normal</a></span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='prm_log_normal.html'>prm_log_normal</a></span><span class='op'>(</span><span class='st'>"cl"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='compartment.html'>compartment</a></span><span class='op'>(</span><span class='st'>"central"</span>, volume <span class='op'>=</span> <span class='op'>~</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'>flow</span><span class='op'>(</span><span class='fu'><a href='declaration.html'>declaration</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>cl</span><span class='op'>*</span><span class='va'>C</span><span class='op'>)</span>, from <span class='op'>=</span> <span class='st'>"central"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='obs_additive.html'>obs_additive</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>C</span><span class='op'>[</span><span class='st'>"central"</span><span class='op'>]</span><span class='op'>)</span>
<span class='co'># an analytic solution is generated</span>
<span class='fu'><a href='render.html'>render</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $PROBLEM
#&gt; $INPUT ID TIME DV AMT
#&gt; $DATA data.csv IGNORE=@
#&gt; $SUBROUTINES ADVAN1  TRANS2 
#&gt; $PK
#&gt; V = THETA(1) * EXP(ETA(1))
#&gt; CL = THETA(2) * EXP(ETA(2))
#&gt; $ERROR
#&gt; Y = A(1)/V + EPS(1)
#&gt; $ESTIMATION METHOD=COND MAXEVAL=999999 
#&gt; $THETA (0, 1, Inf) ; POP_V
#&gt; $THETA (0, 1, Inf) ; POP_CL
#&gt; $OMEGA 0.1 ; IIV_V
#&gt; $OMEGA 0.1 ; IIV_CL
#&gt; $SIGMA 1; RUV_ADD</div><div class='input'>
<span class='co'># one-compartment model with Michaelis-Menten elimination</span>
<span class='va'>m2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='model.html'>model</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='prm_log_normal.html'>prm_log_normal</a></span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='prm_log_normal.html'>prm_log_normal</a></span><span class='op'>(</span><span class='st'>"vmax"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='prm_no_var.html'>prm_no_var</a></span><span class='op'>(</span><span class='st'>"km"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='compartment.html'>compartment</a></span><span class='op'>(</span><span class='st'>"central"</span>, volume <span class='op'>=</span> <span class='op'>~</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'>flow</span><span class='op'>(</span><span class='fu'><a href='declaration.html'>declaration</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>vmax</span><span class='op'>*</span><span class='va'>C</span><span class='op'>/</span><span class='op'>(</span><span class='va'>km</span><span class='op'>+</span><span class='va'>C</span><span class='op'>)</span><span class='op'>)</span>, from <span class='op'>=</span> <span class='st'>"central"</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'><a href='obs_additive.html'>obs_additive</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>C</span><span class='op'>[</span><span class='st'>"central"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'># an ODE is generated</span>
<span class='fu'><a href='render.html'>render</a></span><span class='op'>(</span><span class='va'>m2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $PROBLEM
#&gt; $INPUT ID TIME DV AMT
#&gt; $DATA data.csv IGNORE=@
#&gt; $SUBROUTINES ADVAN13 TOL=6
#&gt; $MODEL COMP=(CENTRAL)
#&gt; $PK
#&gt; V = THETA(1) * EXP(ETA(1))
#&gt; VMAX = THETA(2) * EXP(ETA(2))
#&gt; KM = THETA(3)
#&gt; $DES
#&gt; DADT(1) = -(VMAX * (A(1)/V)/(KM + A(1)/V))
#&gt; $ERROR
#&gt; Y = A(1)/V + EPS(1)
#&gt; $ESTIMATION METHOD=COND MAXEVAL=999999 
#&gt; $THETA (0, 1, Inf) ; POP_V
#&gt; $THETA (0, 1, Inf) ; POP_VMAX
#&gt; $THETA (0, 1, Inf) ; POP_KM
#&gt; $OMEGA 0.1 ; IIV_V
#&gt; $OMEGA 0.1 ; IIV_VMAX
#&gt; $SIGMA 1; RUV_ADD</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Ueckert, F. Hoffmann-La Roche Ltd..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


